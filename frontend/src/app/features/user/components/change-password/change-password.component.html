<div class="min-h-[78vh] bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center px-4">
    <div class="bg-white rounded-xl shadow-sm w-full max-w-md p-4">
      <div class="py-6 px-4">
        <svg class="mx-auto h-12 w-auto text-[#8B9F82]" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2" fill="currentColor" />
          <line x1="6" y1="8" x2="18" y2="8" stroke="white" stroke-width="1.5" />
          <line x1="6" y1="12" x2="18" y2="12" stroke="white" stroke-width="1.5" />
          <line x1="6" y1="16" x2="14" y2="16" stroke="white" stroke-width="1.5" />
          <path d="M20 3l1 1-7 7-1-1 7-7z" fill="white" />
          <path d="M19 4l1 1-1 1-1-1 1-1z" fill="white" />
        </svg>
  
        <h2 class="mt-4 text-center text-2xl font-bold text-gray-600">
          Setup your new password
        </h2>
  
        <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmits()" class="mt-6 space-y-4">

          <div>
            <label 
              for="password" 
              class="block mb-2 text-sm font-medium"
              [ngClass]="{'text-red-700': changePasswordForm.get('oldPassword')?.invalid && changePasswordForm.get('oldPassword')?.touched}"
            >
              Password
            </label>
            <div class="relative">
              <input
                [type]="showOldPassword ? 'text' : 'password'"
                id="oldPassword"
                formControlName="oldPassword"
                class="border text-sm rounded-lg block w-full p-2 focus:outline-none"
                [ngClass]="{
                  'bg-red-50 border-red-500 text-red-900 placeholder-red-700': 
                  changePasswordForm.get('oldPassword')?.invalid && changePasswordForm.get('oldPassword')?.touched
                }"
                placeholder="Old password"
              />
              <button
                type="button"
                class="absolute inset-y-0 right-0 pr-3 flex items-center"
                (click)="toggleOldPasswordVisibility()"
              >
                @if(showOldPassword){
                  <fa-icon [icon]="faEyeSlash" class="text-gray-500"></fa-icon>
                }@else {
                  <fa-icon [icon]="faEye" class="text-gray-500"></fa-icon>
                }
              </button>
            </div>
            <div 
              class="text-sm text-red-600 mt-1" 
              *ngIf="changePasswordForm.get('oldPassword')?.invalid && changePasswordForm.get('oldPassword')?.touched"
            >
              <small *ngIf="changePasswordForm.get('oldPassword')?.errors?.['required']" class="font-semibold">
                * Old password is required
              </small>
            </div>
          </div>

          <!-- Password Section -->
          <div>
            <label 
              for="newPassword" 
              class="block mb-2 text-sm font-medium"
              [ngClass]="{'text-red-700': changePasswordForm.get('newPassword')?.invalid && changePasswordForm.get('newPassword')?.touched}"
            >
              Password
            </label>
            <div class="relative">
              <input
                [type]="showPassword ? 'text' : 'password'"
                id="newPassword"
                formControlName="newPassword"
                class="border text-sm rounded-lg block w-full p-2 focus:outline-none"
                [ngClass]="{
                  'bg-red-50 border-red-500 text-red-900 placeholder-red-700': 
                  changePasswordForm.get('newPassword')?.invalid && changePasswordForm.get('newPassword')?.touched
                }"
                placeholder="New Password"
              />
              <button
                type="button"
                class="absolute inset-y-0 right-0 pr-3 flex items-center"
                (click)="togglePasswordVisibility()"
              >
                @if(showPassword){
                  <fa-icon [icon]="faEyeSlash" class="text-gray-500"></fa-icon>
                }@else {
                  <fa-icon [icon]="faEye" class="text-gray-500"></fa-icon>
                }
              </button>
            </div>
            <div 
              class="text-sm text-red-600 mt-1" 
              *ngIf="changePasswordForm.get('newPassword')?.invalid && changePasswordForm.get('newPassword')?.touched"
            >
              <small *ngIf="changePasswordForm.get('newPassword')?.errors?.['required']" class="font-semibold">
                * Password is required
              </small>
              <small *ngIf="changePasswordForm.get('newPassword')?.errors?.['minlength']" class="font-semibold">
                * Minimum 8 characters
              </small>
              <small *ngIf="changePasswordForm.get('newPassword')?.errors?.['weakPassword']" class="font-semibold">
                * Password must include uppercase, lowercase, number, and special character
              </small>
            </div>
          </div>
  
          <!-- Confirm Password Section -->
          <div>
            <label 
              for="confirmPassword" 
              class="block mb-2 text-sm font-medium"
              [ngClass]="{'text-red-700': changePasswordForm.get('confirmPassword')?.invalid && changePasswordForm.get('confirmPassword')?.touched}"
            >
              Confirm Password
            </label>
            <div class="relative">
              <input
                [type]="showPasswordConfirm ? 'text' : 'password'"
                id="confirmPassword"
                formControlName="confirmPassword"
                class="border text-sm rounded-lg block w-full p-2 focus:outline-none"
                [ngClass]="{
                  'bg-red-50 border-red-500 text-red-900 placeholder-red-700': 
                  changePasswordForm.get('confirmPassword')?.invalid && changePasswordForm.get('confirmPassword')?.touched
                }"
                placeholder="Confirm Password"
              />
              <button
                type="button"
                class="absolute inset-y-0 right-0 pr-3 flex items-center"
                (click)="toggleConfirmPasswordVisibility()"
              >
                @if(showPasswordConfirm){
                  <fa-icon [icon]="faEyeSlash" class="text-gray-500"></fa-icon>
                }@else {
                  <fa-icon [icon]="faEye" class="text-gray-500"></fa-icon>
                }
              </button>
            </div>
            <div 
              class="text-sm text-red-600 mt-1" 
              *ngIf="changePasswordForm.get('confirmPassword')?.invalid && changePasswordForm.get('confirmPassword')?.touched"
            >
              <small *ngIf="changePasswordForm.get('confirmPassword')?.errors?.['required']" class="font-semibold">
                * Confirm Password is required
              </small>
              <small *ngIf="changePasswordForm.get('confirmPassword')?.errors?.['minlength']" class="font-semibold">
                * Minimum 8 characters
              </small>
              <small *ngIf="changePasswordForm.get('confirmPassword')?.errors?.['passwordMismatch']" class="font-semibold">
                * Passwords must match
              </small>
            </div>
          </div>
  
          <div>
            <button
              type="submit"
              [disabled]="changePasswordForm.invalid || isLoading"
              class="w-full py-2 px-4 rounded-md text-sm font-medium text-white bg-[#8B9F82] hover:bg-[#8B9F82]/95 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              {{ isLoading ? "Requesting..." : "Reset password" }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>